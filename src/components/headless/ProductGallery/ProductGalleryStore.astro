---
import { ProductGalleryContext } from "./ProductGalleryContext";
import {
    createProductGalleryStore,
    type ProductGalleryStoreInput,
} from "../ProductGallery/ProductGalleryStore";
import { getSelectedVariantStoreId } from "../VariantSelector/VariantSelectorContext";
import GenericStore from "../GenericStore.astro";

type Props = Omit<ProductGalleryStoreInput, "dependantStoreIds">;

const selectedVariantStoreId = getSelectedVariantStoreId();
---

<GenericStore
    {...Astro.props}
    storeSlug="productGallery"
    storeFactory={createProductGalleryStore}
    dependantStoreIds={{ selectedVariantStoreId }}>
    {(storeId: string) =>
        <ProductGalleryContext storeId={storeId}>
            {Astro.slots.render("default", [storeId])}
        </ProductGalleryContext>
    }
</GenericStore>